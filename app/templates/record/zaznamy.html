{% extends 'base.html' %}

{% block head %}
<title>Záznamy</title>
<link rel="stylesheet" href="{{url_for('static', filename='css/styly.css')}}" >
{% endblock %}

{% block body %}    
<div>
    <h1>
      <b> Záznamy v deníku </b>
    </h1>
    <form action="/zaznamy/{{serazeni}}/" method="post">
        <h2>Filtry:</h2>
        <h4>Jazyky</h4>
        {% for language in languages %}

            <label for="{{language.name}}">{{language.name}}</label>
            <input type="checkbox" id="{{language.name}}" name="{{language.name}}"
            {% if filtered_languages[language.id] == "on" %}
                checked
            {% endif %}
            >
        {% endfor %}
        <br>
        <br>
        <h4>Čas strávený v minutách</h4>
        <label for="time_from">od</label>
        <input type="number" placeholder="od" id="time_from" name="time_from" value="{{min_time}}" required style="width: 55px;">
        <label for="time_to">do</label>
        <input type="number" placeholder="do" id="time_to" name="time_to" value="{{max_time}}" required style="width: 55px;">
        <br>
        <br>

        <h4>Datum</h4>
        <label for="date_from">od</label>
        <input type="date" id="date_from" name="date_from" value="{{min_date}}" required>
        <label for="date_to">do</label>
        <input type="date" id="date_to" name="date_to" value="{{max_date}}" required>
        <br>
        <br>
        <h4>Hodnocení</h4>
        <label for="hodnoceni_from">od</label>
        <input type="number" placeholder="od" id="hodnoceni_from" name="hodnoceni_from" value="{{min_hod}}" max="5" min="1" required style="width: 55px;">
        <label for="hodnoceni_to">do</label>
        <input type="number" placeholder="do" id="hodnoceni_to" name="hodnoceni_to" value="{{max_hod}}" max="5" min="1" required style="width: 55px;">
        <br>
        <br>
        {% if user.auth <= 1 %}
       <h4>Programátor</h4>
        <select name="name" style="width: 200px;">

            <option value="-1"> všichni </option>
            {% for usr in users %}
            <option value="{{usr.id}}"
            {% if usr.id == sel_name %} selected {% endif %}>{{usr.name}}</option>
            {% endfor %}

        </select>
        <br>
        <br>
        {% endif %}
        <h4>Štítky</h4>
            <input type="checkbox" id="bezkatky0" name="0" 
            {% if filtered_tags[0] == "on" %}
            checked
            {% endif %}>
            <label for="bezkatky0">  Bez kategorie</label>
        {% for tag in tags %}
            <input type="checkbox" id="{{tag.name}}" name="{{tag.name}}"
            
            {% if filtered_tags[tag.id] == "on" %}
                checked
            {% endif %}
            >
            <label for="{{tag.name}}" style="color: {{tag.barva}};"> {{tag.name}}</label>
        {% endfor %}

        <br>  
        <br>
       <p style="text-align: center;" ><input type="submit" value="filtrovat"> </p>

    </form>
    <br>
    <form action="/zaznamy/reset-filter" method="get">
        <p style="text-align: center;" >    <input type="submit" value="reset filtru"> </p>
    </form>
</div>

<div>

    <table>
    <tr>
        <th style="padding-right:  20px; text-align: left;"><a href="/zaznamy/{% if serazeni == 9 %}10{% else %}9{% endif %}/">Jméno 
            {% if serazeni == 9 %}<img src="{{url_for('static', filename='images/nahoru.png')}}" alt="serazeni" class="sipky">{% endif %}
            {% if serazeni == 10 %}<img src="{{url_for('static', filename='images/dolu.png')}}" alt="logo" class="sipky">{% endif %}
        </a></th>
        <th style="padding-right:  20px; text-align: left;"><a href="/zaznamy/{% if serazeni == 7 %}8{% else %}7{% endif %}/">Jazyk 
            {% if serazeni == 7 %}<img src="{{url_for('static', filename='images/nahoru.png')}}" alt="serazeni" class="sipky">{% endif %}
            {% if serazeni == 8 %}<img src="{{url_for('static', filename='images/dolu.png')}}" alt="logo" class="sipky">{% endif %}
        </a></th>
        <th style="padding-right:  20px; text-align: left;"><a href="/zaznamy/{% if serazeni == 3 %}4{% else %}3{% endif %}/">Čas strávený v min
            {% if serazeni == 4 %}<img src="{{url_for('static', filename='images/nahoru.png')}}" alt="serazeni" class="sipky">{% endif %}
            {% if serazeni == 3 %}<img src="{{url_for('static', filename='images/dolu.png')}}" alt="logo" class="sipky">{% endif %}
        </a></th>
        <th style="text-align: left;">Popis</th>
        <th style="padding-right:  30px; text-align: left;"><a href="/zaznamy/{% if serazeni == 1 %}2{% else %}1{% endif %}/">Datum
            {% if serazeni == 1 %}<img src="{{url_for('static', filename='images/nahoru.png')}}" alt="serazeni" class="sipky">{% endif %}
            {% if serazeni == 2 %}<img src="{{url_for('static', filename='images/dolu.png')}}" alt="logo" class="sipky">{% endif %}
        </a></th>
        <th style="padding-right:  30px; text-align: left;"><a href="/zaznamy/{% if serazeni == 5 %}6{% else %}5{% endif %}/">Hodnocení
            {% if serazeni == 6 %}<img src="{{url_for('static', filename='images/nahoru.png')}}" alt="serazeni" class="sipky">{% endif %}
            {% if serazeni == 5 %}<img src="{{url_for('static', filename='images/dolu.png')}}" alt="logo" class="sipky">{% endif %}
        </a></th>
        <th style="padding-right:  30px; text-align: left;">Štítky</th>
        <th style="padding-right:  30px; text-align: left;">Možnosti</th>
    </tr>
    {% for record in records %}
        {% if user.auth <= 1 or user.id == record.name %}
        <tr>
            <td style=" width: 125px; overflow-wrap: break-word; word-break: break-all;">{% for usr in users %}

                {% if usr.id == record.name %}
                    {{usr.name}}
                {% endif %}
            {% endfor %}</td>

            <td style=" text-align: center;">

                {% for language in languages %}
                    {% if language.id == record.jazyk_id %}
                        {{language.name}}
                    {% endif %}
                {% endfor %}
                </td>
            
            <td style="text-align: center;">{{record.time_spent}}</td>
            <td style=" width: 200px; word-wrap: break-word; word-break: break-all;">{{record.popis}}</td>
            <td>{{record.date[8:] + "-" + record.date[5:7] + "-" + record.date[:4]}}</td>
            <td style="text-align: center;">{{record.hodnoceni}}</td>
            <td>
                {% for cat in cats %}
                    {% if cat.owned_id == record.id %}
                        {% for tag in tags %}
                            {% if cat.type_id == tag.id %}
                            <p style="color: {{tag.barva}};">{{tag.name}}</p>
                                <br>
                            {% endif %}
                        {% endfor %}
                    {% endif %}
                {% endfor %}
            </td>
            {% if user.auth <= 1 or user.id == record.name %}
            <td> <a href="/update-form/{{record.id}}">Upravit</a>  <br>
                <a href="/delete/{{record.id}}" class="smazat confirmation">Smazat</a>  </td>
            {% endif %}
        </tr>

        {% endif %}
    {% endfor %}
    </table>
</div>


{% endblock %}