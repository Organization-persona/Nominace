{% extends 'base.html' %}

{% block head %}
<title>Záznamy</title>
<link rel="stylesheet" href="{{url_for('static', filename='css/styly.css')}}" >
{% endblock %}

{% block body %}    
<div>
    <h1>
      <b> Záznamy v deníku </b>
    </h1>
    <form action="/zaznamy/{{serazeni}}/" method="post">
        <h2>Filtry:</h2>
        <h4>Jazyky</h4>
        {% for language in languages %}

            <label for="{{language.name}}">{{language.name}}</label>
            <input type="checkbox" id="{{language.name}}" name="{{language.name}}"
            {% if filtered_languages[language.id] == "on" %}
                checked
            {% endif %}
            >
        {% endfor %}
        <br>
        <br>
        <h4>Čas programování</h4>
        <label for="time_from">od</label>
        <input type="number" placeholder="od" name="time_from" value="{{min_time}}" required style="width: 55px;">
        <label for="time_to">do</label>
        <input type="number" placeholder="do" name="time_to" value="{{max_time}}" required style="width: 55px;">
        <br>
        <br>

        <h4>Datum</h4>
        <label for="date_from">od</label>
        <input type="date" name="date_from" value="{{min_date}}" required>
        <label for="date_from">do</label>
        <input type="date" name="date_to" value="{{max_date}}" required>
        <br>
        <br>
        <h4>Hodnocení</h4>
        <label for="hodnoceni_from">od</label>
        <input type="number" placeholder="od" name="hodnoceni_from" value="{{min_hod}}" required style="width: 55px;">
        <label for="hodnoceni_to">do</label>
        <input type="number" placeholder="do" name="hodnoceni_to" value="{{max_hod}}" required style="width: 55px;">
        <br>
        <br>
        {% if user.auth <= 1 %}
       <h4>Programátor</h4>
        <select name="name" style="width: 200px;">

            <option value="-1"> všichni </option>
            {% for usr in users %}
            <option value="{{usr.id}}"
            {% if usr.id == sel_name %} selected {% endif %}>{{usr.name}}</option>
            {% endfor %}

        </select>
        <br>
        <br>
        {% endif %}
        <h4>Štítky</h4>
            <input type="checkbox" id="bezkatky0" name="0" 
            {% if filtered_tags[0] == "on" %}
            checked
            {% endif %}>
            <label for="bezkatky0">  bez kategorie</label>
        {% for tag in tags %}
            <input type="checkbox" id="{{tag.name}}" name="{{tag.name}}"
            
            {% if filtered_tags[tag.id] == "on" %}
                checked
            {% endif %}
            >
            <label for="{{tag.name}}" style="color: {{tag.barva}};"> {{tag.name}}</label>
        {% endfor %}

        <br>  
        <br>
       <p style="text-align: center;" ><input type="submit" value="filtrovat"> </p>

    </form>
    <br>
    <form action="/zaznamy/reset-filter" method="get">
        <p style="text-align: center;" >    <input type="submit" value="reset filtru"> </p>
    </form>
    <br>
    <br>
    <br>
    <form action="/zaznamy/set-serazeni/" method="post">
        <h2>Seřazení:</h2>
        <select name="serazeni" >
            <option value="1" {% if serazeni == 1 %} selected {% endif %}>Datum vzestupně</option>
            <option value="2" {% if serazeni == 2 %} selected {% endif %}>Datum sestupně</option>
            <option value="3" {% if serazeni == 3 %} selected {% endif %}>Čas sestupně</option>
            <option value="4" {% if serazeni == 4 %} selected {% endif %}>Čas vzestupně</option>
            <option value="5" {% if serazeni == 5 %} selected {% endif %}>Hodnocení sestupně</option>
            <option value="6" {% if serazeni == 6 %} selected {% endif %}>Hodnocení vzestupně</option>
            <option value="7" {% if serazeni == 7 %} selected {% endif %}>Programovací jazyk abecedně</option>
        </select>
        <input type="submit" value="Seřadit">
    </form>
</div>

<div>

    <table>
    <tr>
        <th style="padding-right:  20px; text-align: left;">ID</th>
        <th style="padding-right:  20px; text-align: left;">Jméno</th>
        <th style="padding-right:  20px; text-align: left;"><a href="http://localhost:8080/zaznamy/7/">Jazyk</a></th>
        <th style="padding-right:  20px; text-align: left;"><a href="http://localhost:8080/zaznamy/{% if serazeni == 3 %}4{% else %}3{% endif %}/">Čas strávený v min</a></th>
        <th style="text-align: left;">Popis</th>
        <th style="padding-right:  30px; text-align: left;"><a href="http://localhost:8080/zaznamy/{% if serazeni == 1 %}2{% else %}1{% endif %}/">Datum</a></th>
        <th style="padding-right:  30px; text-align: left;"><a href="http://localhost:8080/zaznamy/{% if serazeni == 5 %}6{% else %}5{% endif %}/">Hodnocení</a></th>
        <th style="padding-right:  30px; text-align: left;">Štítky</th>
        <th style="padding-right:  30px; text-align: left;">Možnosti</th>
    </tr>
    {% for record in records %}
        {% if user.auth <= 1 or user.id == record.name %}
        <tr>
            <td>{{record.id}}</td>
            <td style=" width: 125px; overflow-wrap: break-word; word-break: break-all;">{% for usr in users %}

                {% if usr.id == record.name %}
                    {{usr.name}}
                {% endif %}
            {% endfor %}</td>

            <td style=" text-align: center;">

                {% for language in languages %}
                    {% if language.id == record.jazyk_id %}
                        {{language.name}}
                    {% endif %}
                {% endfor %}
                </td>
            
            <td style="text-align: center;">{{record.time_spent}}</td>
            <td style=" width: 200px; word-wrap: break-word; word-break: break-all;">{{record.popis}}</td>
            <td>{{record.date}}</td>
            <td style="text-align: center;">{{record.hodnoceni}}</td>
            <td>
                {% for cat in cats %}
                    {% if cat.owned_id == record.id %}
                        {% for tag in tags %}
                            {% if cat.type_id == tag.id %}
                            <p style="color: {{tag.barva}};">{{tag.name}}</p>
                                <br>
                            {% endif %}
                        {% endfor %}
                    {% endif %}
                {% endfor %}
            </td>
            {% if user.auth <= 1 or user.id == record.name %}
            <td> <a href="/update-form/{{record.id}}"> upravit</a>  <br>
                <a href="/delete/{{record.id}}" > smazat</a>  </td>
            {% endif %}
        </tr>
        {% endif %}
    {% endfor %}
    </table>
</div>

{% endblock %}